import{_ as a,c as n,a as p,o as e}from"./app-pBrtxVLr.js";const l={};function i(c,s){return e(),n("div",null,[...s[0]||(s[0]=[p(`<p>作为一名主要使用MySQL的开发者，最近我入职了一家需要处理地理空间数据的公司，开始接触PostgreSQL（简称PG）数据库。在使用过程中，我发现PG不仅仅是一个关系型数据库，更是一个功能强大的数据平台，特别是其PostGIS扩展，为地理信息系统( GIS)应用提供了强大支持。</p><h2 id="postgresql-vs-mysql-主要区别" tabindex="-1"><a class="header-anchor" href="#postgresql-vs-mysql-主要区别"><span>PostgreSQL vs MySQL：主要区别</span></a></h2><p>在深入了解PostGIS之前，先简单对比一下PostgreSQL和MySQL的主要区别：</p><ol><li><p><strong>架构差异</strong>：</p><ul><li>MySQL：4级结构（实例、数据库、表、列）</li><li>PostgreSQL：5级结构（实例、数据库、模式Schema、表、列）</li></ul></li><li><p><strong>稳定性与性能</strong>：</p><ul><li>PostgreSQL在高并发读写下性能曲线更平稳，负载逼近极限时仍能维持稳定</li><li>MySQL在极端写入密集型工作负载方面可能有优势</li></ul></li><li><p><strong>数据类型与扩展性</strong>：</p><ul><li>PostgreSQL支持更丰富的数据类型（几何类型、数组、JSON等）</li><li>PostgreSQL的扩展系统更为强大，PostGIS就是其中最著名的扩展之一</li></ul></li><li><p><strong>事务与ACID支持</strong>：</p><ul><li>PostgreSQL在所有配置中都完全兼容ACID</li><li>MySQL只有在使用InnoDB和NDB集群存储引擎时才符合ACID标准</li></ul></li><li><p><strong>空间数据处理</strong>：</p><ul><li>PostgreSQL的PostGIS扩展在GIS领域处于优势地位</li><li>MySQL的空间扩展功能相对有限</li></ul></li></ol><h2 id="postgis简介" tabindex="-1"><a class="header-anchor" href="#postgis简介"><span>PostGIS简介</span></a></h2><p>PostGIS是PostgreSQL的一个扩展，为PostgreSQL增加了地理空间数据处理能力。它遵循开放地理空间联盟(OGC)的Simple Features for SQL规范，提供了丰富的地理空间数据类型、函数和索引支持。</p><h3 id="postgis的主要特性" tabindex="-1"><a class="header-anchor" href="#postgis的主要特性"><span>PostGIS的主要特性</span></a></h3><ol><li><p><strong>丰富的几何数据类型</strong>：</p><ul><li>点(Point)、线(LineString)、多边形(Polygon)</li><li>多点(MultiPoint)、多线(MultiLineString)、多多边形(MultiPolygon)</li><li>几何集合(GeometryCollection)</li><li>3D类型如TIN和多面体表面</li></ul></li><li><p><strong>球面坐标支持</strong>：</p><ul><li>通过geography数据类型支持球面坐标系统</li><li>直接处理经纬度坐标，无需投影转换</li></ul></li><li><p><strong>栅格数据支持</strong>：</p><ul><li>支持各种像素类型和每个栅格超过1000个波段</li><li>通过postgis_raster扩展提供</li></ul></li><li><p><strong>空间索引</strong>：</p><ul><li>基于GiST(广义搜索树)的R树空间索引</li><li>高效的空间查询性能</li></ul></li><li><p><strong>拓扑支持</strong>：</p><ul><li>通过postgis_topology扩展提供SQL/MM拓扑支持</li></ul></li></ol><h2 id="postgis核心函数" tabindex="-1"><a class="header-anchor" href="#postgis核心函数"><span>PostGIS核心函数</span></a></h2><p>PostGIS提供了大量用于空间数据处理的函数，以下是一些常用的核心函数：</p><h3 id="几何对象创建函数" tabindex="-1"><a class="header-anchor" href="#几何对象创建函数"><span>几何对象创建函数</span></a></h3><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span>--</span><span class="space"> </span><span>创建点</span></span>
<span class="line"><span>SELECT</span><span class="space"> </span><span>ST_MakePoint(longitude,</span><span class="space"> </span><span>latitude);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>--</span><span class="space"> </span><span>创建线</span></span>
<span class="line"><span>SELECT</span><span class="space"> </span><span>ST_MakeLine(point1,</span><span class="space"> </span><span>point2);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>--</span><span class="space"> </span><span>创建多边形</span></span>
<span class="line"><span>SELECT</span><span class="space"> </span><span>ST_MakePolygon(exterior_ring,</span><span class="space"> </span><span>ARRAY[interior_ring1,</span><span class="space"> </span><span>interior_ring2]);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="空间关系判断函数" tabindex="-1"><a class="header-anchor" href="#空间关系判断函数"><span>空间关系判断函数</span></a></h3><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span>--</span><span class="space"> </span><span>判断两个几何对象是否相交</span></span>
<span class="line"><span>SELECT</span><span class="space"> </span><span>ST_Intersects(geometry1,</span><span class="space"> </span><span>geometry2);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>--</span><span class="space"> </span><span>判断一个几何对象是否包含另一个</span></span>
<span class="line"><span>SELECT</span><span class="space"> </span><span>ST_Contains(geometry1,</span><span class="space"> </span><span>geometry2);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>--</span><span class="space"> </span><span>判断两个几何对象是否相距一定距离内</span></span>
<span class="line"><span>SELECT</span><span class="space"> </span><span>ST_DWithin(geometry1,</span><span class="space"> </span><span>geometry2,</span><span class="space"> </span><span>distance);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="空间测量函数" tabindex="-1"><a class="header-anchor" href="#空间测量函数"><span>空间测量函数</span></a></h3><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span>--</span><span class="space"> </span><span>计算两点间距离</span></span>
<span class="line"><span>SELECT</span><span class="space"> </span><span>ST_Distance(point1,</span><span class="space"> </span><span>point2);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>--</span><span class="space"> </span><span>计算面积</span></span>
<span class="line"><span>SELECT</span><span class="space"> </span><span>ST_Area(polygon);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>--</span><span class="space"> </span><span>计算长度</span></span>
<span class="line"><span>SELECT</span><span class="space"> </span><span>ST_Length(linestring);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="空间处理函数" tabindex="-1"><a class="header-anchor" href="#空间处理函数"><span>空间处理函数</span></a></h3><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span>--</span><span class="space"> </span><span>缓冲区分析</span></span>
<span class="line"><span>SELECT</span><span class="space"> </span><span>ST_Buffer(geometry,</span><span class="space"> </span><span>distance);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>--</span><span class="space"> </span><span>几何对象简化</span></span>
<span class="line"><span>SELECT</span><span class="space"> </span><span>ST_Simplify(geometry,</span><span class="space"> </span><span>tolerance);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>--</span><span class="space"> </span><span>空间交集</span></span>
<span class="line"><span>SELECT</span><span class="space"> </span><span>ST_Intersection(geometry1,</span><span class="space"> </span><span>geometry2);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="坐标系转换函数" tabindex="-1"><a class="header-anchor" href="#坐标系转换函数"><span>坐标系转换函数</span></a></h3><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span>--</span><span class="space"> </span><span>将几何对象从一个坐标系转换到另一个坐标系</span></span>
<span class="line"><span>SELECT</span><span class="space"> </span><span>ST_Transform(geometry,</span><span class="space"> </span><span>target_srid);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>--</span><span class="space"> </span><span>设置几何对象的坐标系</span></span>
<span class="line"><span>SELECT</span><span class="space"> </span><span>ST_SetSRID(geometry,</span><span class="space"> </span><span>srid);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="实际应用场景" tabindex="-1"><a class="header-anchor" href="#实际应用场景"><span>实际应用场景</span></a></h2><p>PostGIS在许多领域有广泛应用，以下是几个典型场景：</p><h3 id="_1-位置服务与导航" tabindex="-1"><a class="header-anchor" href="#_1-位置服务与导航"><span>1. 位置服务与导航</span></a></h3><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span>--</span><span class="space"> </span><span>查找距离指定位置5公里范围内的所有餐厅</span></span>
<span class="line"><span>SELECT</span><span class="space"> </span><span>name,</span><span class="space"> </span><span>address,</span><span class="space"> </span><span>ST_Distance(</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>geography(location),</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>geography(ST_SetSRID(ST_MakePoint(longitude,</span><span class="space"> </span><span>latitude),</span><span class="space"> </span><span>4326))</span></span>
<span class="line"><span>)</span><span class="space"> </span><span>AS</span><span class="space"> </span><span>distance</span></span>
<span class="line"><span>FROM</span><span class="space"> </span><span>restaurants</span></span>
<span class="line"><span>WHERE</span><span class="space"> </span><span>ST_DWithin(</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>geography(location),</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>geography(ST_SetSRID(ST_MakePoint(longitude,</span><span class="space"> </span><span>latitude),</span><span class="space"> </span><span>4326)),</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>5000</span></span>
<span class="line"><span>)</span></span>
<span class="line"><span>ORDER</span><span class="space"> </span><span>BY</span><span class="space"> </span><span>distance;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_2-地理围栏-geofencing" tabindex="-1"><a class="header-anchor" href="#_2-地理围栏-geofencing"><span>2. 地理围栏(Geofencing)</span></a></h3><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span>--</span><span class="space"> </span><span>判断一个点是否在指定区域内</span></span>
<span class="line"><span>SELECT</span><span class="space"> </span><span>ST_Contains(</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>area_polygon,</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>ST_SetSRID(ST_MakePoint(longitude,</span><span class="space"> </span><span>latitude),</span><span class="space"> </span><span>4326)</span></span>
<span class="line"><span>)</span><span class="space"> </span><span>AS</span><span class="space"> </span><span>is_inside</span></span>
<span class="line"><span>FROM</span><span class="space"> </span><span>geofence_areas</span></span>
<span class="line"><span>WHERE</span><span class="space"> </span><span>area_id</span><span class="space"> </span><span>=</span><span class="space"> </span><span>123;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_3-空间分析与统计" tabindex="-1"><a class="header-anchor" href="#_3-空间分析与统计"><span>3. 空间分析与统计</span></a></h3><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span>--</span><span class="space"> </span><span>计算每个行政区内的商店数量</span></span>
<span class="line"><span>SELECT</span><span class="space"> </span><span>a.district_name,</span><span class="space"> </span><span>COUNT(s.id)</span><span class="space"> </span><span>AS</span><span class="space"> </span><span>shop_count</span></span>
<span class="line"><span>FROM</span><span class="space"> </span><span>administrative_areas</span><span class="space"> </span><span>a</span></span>
<span class="line"><span>JOIN</span><span class="space"> </span><span>shops</span><span class="space"> </span><span>s</span><span class="space"> </span><span>ON</span><span class="space"> </span><span>ST_Contains(a.geometry,</span><span class="space"> </span><span>s.location)</span></span>
<span class="line"><span>GROUP</span><span class="space"> </span><span>BY</span><span class="space"> </span><span>a.district_name</span></span>
<span class="line"><span>ORDER</span><span class="space"> </span><span>BY</span><span class="space"> </span><span>shop_count</span><span class="space"> </span><span>DESC;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="_4-路径规划" tabindex="-1"><a class="header-anchor" href="#_4-路径规划"><span>4. 路径规划</span></a></h3><div class="language-sql line-numbers-mode" data-ext="sql" data-title="sql"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span>--</span><span class="space"> </span><span>使用pgRouting扩展(基于PostGIS)进行最短路径查询</span></span>
<span class="line"><span>SELECT</span><span class="space"> </span><span>*</span><span class="space"> </span><span>FROM</span><span class="space"> </span><span>pgr_dijkstra(</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>&#39;SELECT</span><span class="space"> </span><span>id,</span><span class="space"> </span><span>source,</span><span class="space"> </span><span>target,</span><span class="space"> </span><span>cost,</span><span class="space"> </span><span>reverse_cost</span><span class="space"> </span><span>FROM</span><span class="space"> </span><span>road_network&#39;,</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>start_node_id,</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>end_node_id,</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>directed</span><span class="space"> </span><span>:=</span><span class="space"> </span><span>true</span></span>
<span class="line"><span>);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="总结" tabindex="-1"><a class="header-anchor" href="#总结"><span>总结</span></a></h2><p>PostgreSQL结合PostGIS提供了强大的空间数据处理能力，远超MySQL的空间扩展。对于需要处理地理信息的应用，特别是地图服务、位置分析、路径规划等场景，PostgreSQL+PostGIS是一个非常理想的选择。</p><p>作为一个从MySQL迁移到PostgreSQL的开发者，我发现学习曲线并不陡峭，而获得的空间数据处理能力却是质的飞跃。如果你的应用需要处理地理空间数据，强烈推荐尝试PostgreSQL和PostGIS的组合。</p><h2 id="参考资源" tabindex="-1"><a class="header-anchor" href="#参考资源"><span>参考资源</span></a></h2><ul><li><a href="https://postgis.net/docs/" target="_blank" rel="noopener noreferrer">PostGIS官方文档</a></li><li><a href="https://www.postgresql.org/docs/" target="_blank" rel="noopener noreferrer">PostgreSQL官方文档</a></li><li><a href="https://postgis.net/workshops/postgis-intro/" target="_blank" rel="noopener noreferrer">PostGIS教程</a></li></ul>`,35)])])}const r=a(l,[["render",i]]),d=JSON.parse(`{"path":"/article/d37f9gvt/","title":"工作扫盲之Postgres","lang":"zh-CN","frontmatter":{"title":"工作扫盲之Postgres","createTime":"2025/09/23 07:14:00","permalink":"/article/d37f9gvt/","description":"作为一名主要使用MySQL的开发者，最近我入职了一家需要处理地理空间数据的公司，开始接触PostgreSQL（简称PG）数据库。在使用过程中，我发现PG不仅仅是一个关系型数据库，更是一个功能强大的数据平台，特别是其PostGIS扩展，为地理信息系统( GIS)应用提供了强大支持。 PostgreSQL vs MySQL：主要区别 在深入了解PostGI...","head":[["meta",{"property":"og:url","content":"https://callmeexiao.baby/article/d37f9gvt/"}],["meta",{"property":"og:site_name","content":"Exiao's Blog"}],["meta",{"property":"og:title","content":"工作扫盲之Postgres"}],["meta",{"property":"og:description","content":"作为一名主要使用MySQL的开发者，最近我入职了一家需要处理地理空间数据的公司，开始接触PostgreSQL（简称PG）数据库。在使用过程中，我发现PG不仅仅是一个关系型数据库，更是一个功能强大的数据平台，特别是其PostGIS扩展，为地理信息系统( GIS)应用提供了强大支持。 PostgreSQL vs MySQL：主要区别 在深入了解PostGI..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2026-02-04T02:20:05.000Z"}],["meta",{"property":"article:modified_time","content":"2026-02-04T02:20:05.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"工作扫盲之Postgres\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2026-02-04T02:20:05.000Z\\",\\"author\\":[]}"]]},"headers":[],"readingTime":{"minutes":4.06,"words":1218},"git":{"updatedTime":1770171605000,"contributors":[{"name":"exiao","username":"exiao","email":"574355578@qq.com","commits":1,"avatar":"https://avatars.githubusercontent.com/exiao?v=4","url":"https://github.com/exiao"},{"name":"金逸霄","username":"金逸霄","email":"yixiaojin@ptkj.net","commits":1,"avatar":"https://avatars.githubusercontent.com/金逸霄?v=4","url":"https://github.com/金逸霄"}]},"autoDesc":true,"filePathRelative":"后端技术/工作扫盲之Postgres.md","categoryList":[{"id":"543517","sort":10001,"name":"后端技术"}]}`);export{r as comp,d as data};
