import{_ as a,c as n,a as p,o as e}from"./app-pBrtxVLr.js";const c={};function l(t,s){return e(),n("div",null,[...s[0]||(s[0]=[p(`<h2 id="_1-问题现象" tabindex="-1"><a class="header-anchor" href="#_1-问题现象"><span>1. 问题现象</span></a></h2><p>在市级视图下，仍然可以点击到其他市的区县； 并且鼠标悬停时也会高亮范围外的行政区。</p><h2 id="_2-根因分析" tabindex="-1"><a class="header-anchor" href="#_2-根因分析"><span>2. 根因分析</span></a></h2><p>地图上的行政区是一个个“要素（Feature）”，鼠标点击/移动时都会命中这些要素。 之前的逻辑只负责“高亮样式”显示，但<strong>没有限制点击/高亮必须属于当前行政区范围</strong>。</p><p>另外，点击事件监听没有随着“当前行政区”变化更新，导致使用的是旧状态。</p><h2 id="_3-修复方案-核心思路" tabindex="-1"><a class="header-anchor" href="#_3-修复方案-核心思路"><span>3. 修复方案（核心思路）</span></a></h2><p><strong>思路一句话：</strong> 对行政区要素先做“编码前缀校验”，不属于当前范围的直接忽略。</p><h3 id="_3-1-点击逻辑限制范围" tabindex="-1"><a class="header-anchor" href="#_3-1-点击逻辑限制范围"><span>3.1 点击逻辑限制范围</span></a></h3><ul><li>位置：地图点击事件处理</li><li>做法： <ul><li>获取当前行政区编码 <code>currentArea.code</code></li><li>获取要素编码 <code>xzq_dm</code></li><li>如果 <code>xzq_dm</code> <strong>不以</strong> <code>currentArea.code</code> 开头，则直接 <code>return</code></li></ul></li></ul><h3 id="_3-2-事件监听更新" tabindex="-1"><a class="header-anchor" href="#_3-2-事件监听更新"><span>3.2 事件监听更新</span></a></h3><ul><li>位置：点击事件的 <code>useEffect</code></li><li>做法： <ul><li>把 <code>currentArea</code> 加入依赖</li><li>确保监听器使用最新行政区状态</li></ul></li></ul><h3 id="_3-3-悬停高亮限制范围" tabindex="-1"><a class="header-anchor" href="#_3-3-悬停高亮限制范围"><span>3.3 悬停高亮限制范围</span></a></h3><ul><li>位置：<code>pointermove</code> 高亮逻辑</li><li>做法： <ul><li>如果要素属于行政区，但编码不在当前范围内，则清除高亮并返回</li></ul></li></ul><h2 id="_4-用到的-react-概念" tabindex="-1"><a class="header-anchor" href="#_4-用到的-react-概念"><span>4. 用到的 React 概念</span></a></h2><h3 id="_4-1-useeffect-是什么" tabindex="-1"><a class="header-anchor" href="#_4-1-useeffect-是什么"><span>4.1 <code>useEffect</code> 是什么？</span></a></h3><p><strong>简化理解：</strong> 当某些数据变化时，自动执行一段代码。 常用来做“绑定事件”“发请求”等副作用。</p><p>示例（简化）：</p><div class="language-tsx line-numbers-mode" data-ext="tsx" data-title="tsx"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span>useEffect(()</span><span class="space"> </span><span>=&gt;</span><span class="space"> </span><span>{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span>//</span><span class="space"> </span><span>绑定事件/请求数据</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span>return</span><span class="space"> </span><span>()</span><span class="space"> </span><span>=&gt;</span><span class="space"> </span><span>{</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span class="space"> </span><span>//</span><span class="space"> </span><span>清理事件/请求</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span>};</span></span>
<span class="line"><span>},</span><span class="space"> </span><span>[依赖列表]);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>依赖列表告诉 React： 只有这些依赖变化时，useEffect 才会重新执行。</p><h2 id="_5-修复流程图" tabindex="-1"><a class="header-anchor" href="#_5-修复流程图"><span>5. 修复流程图</span></a></h2><div class="language-mermaid line-numbers-mode" data-ext="mermaid" data-title="mermaid"><button class="copy" title="复制代码" data-copied="已复制"></button><pre class="shiki one-dark-pro vp-code"><code><span class="line"><span>flowchart</span><span class="space"> </span><span>TD</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span>A[鼠标移动]</span><span class="space"> </span><span>--&gt;</span><span class="space"> </span><span>B[地图获取像素下的要素</span><span class="space"> </span><span>Feature]</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span>B</span><span class="space"> </span><span>--&gt;</span><span class="space"> </span><span>C{是否有要素?}</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span>C</span><span class="space"> </span><span>--</span><span class="space"> </span><span>否</span><span class="space"> </span><span>--&gt;</span><span class="space"> </span><span>D[清除高亮]</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span>C</span><span class="space"> </span><span>--</span><span class="space"> </span><span>是</span><span class="space"> </span><span>--&gt;</span><span class="space"> </span><span>E{是否为行政区要素?}</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span>E</span><span class="space"> </span><span>--</span><span class="space"> </span><span>否</span><span class="space"> </span><span>--&gt;</span><span class="space"> </span><span>F[允许高亮]</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span>E</span><span class="space"> </span><span>--</span><span class="space"> </span><span>是</span><span class="space"> </span><span>--&gt;</span><span class="space"> </span><span>G{要素编码是否以当前行政区编码开头?}</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span>G</span><span class="space"> </span><span>--</span><span class="space"> </span><span>否</span><span class="space"> </span><span>--&gt;</span><span class="space"> </span><span>D</span></span>
<span class="line"><span class="space"> </span><span class="space"> </span><span>G</span><span class="space"> </span><span>--</span><span class="space"> </span><span>是</span><span class="space"> </span><span>--&gt;</span><span class="space"> </span><span>F</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>点击逻辑与上述一致，只是“高亮”变成“选中/下钻”。</p><h2 id="_6-影响范围" tabindex="-1"><a class="header-anchor" href="#_6-影响范围"><span>6. 影响范围</span></a></h2><ul><li>点击事件处理模块</li><li>悬停高亮模块</li><li>事件监听逻辑</li></ul>`,24)])])}const r=a(c,[["render",l]]),o=JSON.parse(`{"path":"/article/x7uyj2fp/","title":"地图跨区高亮和点击问题修复记录","lang":"zh-CN","frontmatter":{"title":"地图跨区高亮和点击问题修复记录","createTime":"2026/02/04 09:55:46","permalink":"/article/x7uyj2fp/","description":"1. 问题现象 在市级视图下，仍然可以点击到其他市的区县； 并且鼠标悬停时也会高亮范围外的行政区。 2. 根因分析 地图上的行政区是一个个“要素（Feature）”，鼠标点击/移动时都会命中这些要素。 之前的逻辑只负责“高亮样式”显示，但没有限制点击/高亮必须属于当前行政区范围。 另外，点击事件监听没有随着“当前行政区”变化更新，导致使用的是旧状态。 ...","head":[["meta",{"property":"og:url","content":"https://callmeexiao.baby/article/x7uyj2fp/"}],["meta",{"property":"og:site_name","content":"Exiao's Blog"}],["meta",{"property":"og:title","content":"地图跨区高亮和点击问题修复记录"}],["meta",{"property":"og:description","content":"1. 问题现象 在市级视图下，仍然可以点击到其他市的区县； 并且鼠标悬停时也会高亮范围外的行政区。 2. 根因分析 地图上的行政区是一个个“要素（Feature）”，鼠标点击/移动时都会命中这些要素。 之前的逻辑只负责“高亮样式”显示，但没有限制点击/高亮必须属于当前行政区范围。 另外，点击事件监听没有随着“当前行政区”变化更新，导致使用的是旧状态。 ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2026-02-04T02:20:05.000Z"}],["meta",{"property":"article:modified_time","content":"2026-02-04T02:20:05.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"地图跨区高亮和点击问题修复记录\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2026-02-04T02:20:05.000Z\\",\\"author\\":[]}"]]},"headers":[],"readingTime":{"minutes":1.93,"words":579},"git":{"updatedTime":1770171605000,"contributors":[{"name":"exiao","username":"exiao","email":"exiao@ptkj.net","commits":2,"avatar":"https://avatars.githubusercontent.com/exiao?v=4","url":"https://github.com/exiao"},{"name":"exiao","username":"exiao","email":"574355578@qq.com","commits":1,"avatar":"https://avatars.githubusercontent.com/exiao?v=4","url":"https://github.com/exiao"},{"name":"金逸霄","username":"金逸霄","email":"yixiaojin@ptkj.net","commits":1,"avatar":"https://avatars.githubusercontent.com/金逸霄?v=4","url":"https://github.com/金逸霄"}]},"autoDesc":true,"filePathRelative":"BugFixLogs/地图跨区高亮和点击问题修复记录.md","categoryList":[{"id":"43f493","sort":10006,"name":"BugFixLogs"}]}`);export{r as comp,o as data};
